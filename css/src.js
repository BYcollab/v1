var gwc={locationHref:window.location.href,docScrollTop:$(document).scrollTop(),oldScrollTop:0,isRefresh:true,docHeight:$(document).height(),winHeight:$(window).height(),winWidth:$(window).width(),body:$("body"),header:$(".header"),backTop:$("#back-top"),floatBox:$(".float-box"),preloader:'<div class="preloader"><i class="fa fa-spinner fa-pulse fa-3x fa-fw margin-bottom"></i></div>',articleImgOkCount:0,lazyLoadImg:$(".lazy-load-img"),mainConAll:$(".main-con.show-all"),isRsDetails:$(".rs").length>0,appendModule:function(a){if($("#"+a).length===0){this.body.append('<script type="text/javascript" id="'+a+'" src="/template/default/static/js/module/'+a+'.js"><\/script>')}},appendPlugin:function(a){if($("#"+a).length===0){this.body.append('<script type="text/javascript" id="'+a+'" src="/template/default/static/plugin/'+a+"/js/"+a+'.js"><\/script>')}},modalShow:function(b,a){if($("#"+a+"Modal").length===0){b=b?b:"";this.body.append('<div id="'+a+'Modal" class="gw-modal"><div class="modal-bg"></div><div class="modal-con"><a href="javascript:;" class="close-modal-btn">✕</a>'+b+"</div></div>");$(".modal-bg,.close-modal-btn").click(function(){gwc.modalHide()})}$("#"+a+"Modal").fadeIn(500).find(".modal-con").addClass("in")},modalHide:function(){$(".gw-modal").fadeOut(500).find(".modal-con").removeClass("in")},getDocScrollTop:function(){return $(document).scrollTop()},checkPage:function(a){return $(a).length>0&&true},timePack:function(a){return new Date(a)/1000},timeTransform:function(c,g){var d=new Date(parseInt(c)*1000);var b=d.getFullYear()+"-";var i=(d.getMonth()+1<10?"0"+(d.getMonth()+1):d.getMonth()+1)+"-";var a=d.getDate()+" ";var f=d.getHours()+":";var e=d.getMinutes()+"";var j=d.getSeconds()+"";i.length<=2&&(i="0"+i);a.length<=2&&(a="0"+a);f.length<=2&&(f="0"+f);e.length<=1&&(e="0"+e);j.length<=1?(j=":0"+j):(j=":"+j);if(g===3){return b+i+a}else{if(g===5){return b+i+a+f+e}else{if(g===2){return b.slice(2,5)+i+a}else{return b+i+a+f+e+j}}}},computeRandomNumber:function(a,b){return Math.floor(Math.random()*(a-b+1)+b)},showPrompt:function(c){if($("#prompt-box").length===0){var b=""+'<div id="prompt-box">'+'<style type="text/css">.prompt-tips { font-size: 14px; min-width: 100px; white-space: nowrap; padding: 0 15px; min-height: 40px; line-height: 40px; text-align: center; background: rgba(37, 127, 206, 0.99); position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 5px; color: #fff; box-shadow: 0 0 6px 3px rgba(0, 0, 0, 0.1); z-index: 2147483647; display: none;}</style>'+'<div class="prompt-tips" id="prompt-tips">'+c+"</div>"+"</div>";this.body.append(b);var a=$("#prompt-tips");a.fadeIn(500);setTimeout(function(){a.fadeOut(500);setTimeout(function(){$("#prompt-box").remove()},500)},1500)}},imgUpload:function(d,b){if(typeof FileReader==="undefined"){alert("抱歉，你的浏览器不支持 FileReader");return}var c=d[0].files[0];if(c.type!=="image/png"&&c.type!=="image/jpg"&&c.type!=="image/jpeg"&&c.type!=="image/gif"){alert("只允许上传png/jpg/jpeg/gif格式的图片！");return}else{if(c.size>5000000){alert("图片大小不能超过"+5000000/1000+"kb！");return}}var a=new FileReader();a.readAsDataURL(c);a.onload=function(h){var f=d.parent().parent().find("img");f.attr("src",h.target.result);var g=h.target.result;f[0].onload=function(){var k=document.createElement("canvas");k.setAttribute("id","imgUpCanvas");k.setAttribute("style","display:none");var e=250/(this.naturalWidth/this.naturalHeight);k.width=250;k.height=e;$("#imgUpCanvas").length>0&&$("#imgUpCanvas").remove();$("body").append(k);var i=document.getElementById("imgUpCanvas");var j=i.getContext("2d");j.drawImage(this,0,0,250,e);var l=this.naturalWidth<250?g:i.toDataURL("image/jpeg",0.8);var m={bigImgData:g,smallImgData:l};b&&b(m)}}},browseRecordDataStorage:function(){var a=$(".play-btn.active");if(a.length==0){return}var h=a.attr("data-id");if(h.indexOf("-")>-1){var d="";h=h.split("-");var o=h[0];var m=h[1]}else{d=h;o="";m=""}var e=new Date()/1000;var b=$(".main-content .subject a").text();var c=a.attr("href");var g=a.attr("data-rp0");var f=a.attr("data-rp1");var n=a.text();var k={id:d,siteid:o,movieid:m,time:e,name:b,href:c,rp0:g,rp1:f,title:n};if(localStorage.browseRecord){var l=JSON.parse(localStorage.browseRecord);for(var j=0;j<l.length;j++){if(l[j].id==d&&l[j].siteid==o&&l[j].movieid==m&&l[j].rp0==g&&l[j].rp1==f){l.splice(j,1)}}l.unshift(k);l.length>10&&l.splice(l.length-1,l.length);localStorage.browseRecord=JSON.stringify(l)}else{localStorage.browseRecord=JSON.stringify([k])}},checkIsHasUrl:function(a){var b=/[^\s]+\.[A-Za-z]+/;if(b.test(a)){return true}else{return false}},updateUserLoginState:function(a){$(".float-box .user-wrap").html('<a href="/user/'+a.uid+'" data-id="'+a.uid+'" class="nickname fa" target="_blank" title="'+a.nickname+'"><img src="'+a.avatar+'"></a>');var b='<a href="/user/'+a.uid+'" id="nickname" data-id="'+a.uid+'" class="nickname" target="_blank"><img src="'+a.avatar+'"><i>'+a.nickname+'</i></a> <a href="/user/'+a.uid+'" class="notice"><i class="fa fa-bell-o"></i><em class="num"></em></a> | <a href="/index.php?action=loginout" rel="nofollow" class="login-out">退出</a>';
    $(".top .user-wrap").html(b);if(a.uid){$(".visits").show();$(".recommend-movie.dy").show()}}};if(window!=top){top.location.href=window.location.href}$(window).scroll(function(){gwc.docScrollTop=gwc.getDocScrollTop();if(gwc.docScrollTop-gwc.oldScrollTop>0&&!gwc.isRefresh){gwc.header.addClass("hideOnTop").removeClass("showOnTop");gwc.floatBox.addClass("hideInBottom").removeClass("hideOnTop");gwc.oldScrollTop=gwc.docScrollTop;gwc.isRefresh=false}else{if(gwc.docScrollTop<=0){gwc.header.removeClass("hideOnTop").removeClass("showOnTop")}else{if(gwc.isRefresh){gwc.header.addClass("hideOnTop").removeClass("showOnTop")}else{gwc.floatBox.removeClass("hideInBottom");gwc.header.removeClass("hideOnTop").addClass("showOnTop")}}gwc.isRefresh=false;gwc.oldScrollTop=gwc.docScrollTop}lazyLoad()});gwc.backTop.click(function(){var a=gwc.winWidth>768?666:0;$("html,body").animate({scrollTop:0},a)});$(".put-btn,.comment-btn").click(function(){var b=gwc.winWidth>768?666:0;var a=$(".post-post").offset().top;$("html,body").animate({scrollTop:a},b)});$(".hot-btn").click(function(){var b=gwc.winWidth>768?666:0;var a=$(".hot-wrap").offset().top;$("html,body").animate({scrollTop:a},b)});$("body").delegate(".login-btn, .reg-btn","click",function(){if($("#logRegModule").length===0){gwc.appendModule("logRegModule")}else{gwc.modalShow("","logRegModule")}logRegModule.logRegIn($(this).attr("data-order"))});function lazyLoad(){gwc.lazyLoadImg.each(function(){if(!$(this).hasClass("show")){var a=$(this).offset().top;if(gwc.docScrollTop>=a-gwc.winHeight){$(this).addClass("show").attr("src",computeSrc($(this)))}}})}lazyLoad();function computeSrc(a){if(a.hasClass("gif")){return a.attr("_src").replace(/.gif/,".jpg")}else{return a.attr("_src")}}$("body").delegate(".fabulous","click",function(){if(backData.uid){var b=$(this).find("em").text().indexOf("已赞")==-1?"点赞中...":"取消中...";$(this).addClass("disabled").find("em").text(b)}var d=$(this);var c=$(this).attr("data-id"),a=$(this).attr("class").split(" ")[1].split("-")[0];$.ajax({url:gwc.api2,type:"post",dataType:"json",data:{order:"giveFabulous",id:c,table:a},success:function(f){d.removeClass("disabled");gwc.appendPlugin("pop");if(f.state===-2){$(".login-btn").trigger("click")}else{if(f.state===-1){gwc.showPrompt('<i class="fa fa-hand-grab-o"></i> 我会继续努力');var e=f.num==0?"赞一个":"<b>"+f.num+"</b>赞";$("."+a+"-fabulous-"+c).removeClass("red").find("em").html(e)}else{if(f.state===1){gwc.showPrompt('<i class="fa fa-heartbeat"></i> 非常感谢！积分+'+f.score);$("."+a+"-fabulous-"+c).addClass("red").find("em").html("<b>"+f.num+"</b>已赞")}}}},error:function(e){console.log(e)}})});$("body").delegate(".collect","click",function(){if(backData.uid){var a=$(this).find("em").text();var c=a.indexOf("已收藏")>-1?"取消中...":"收藏中...";$(this).addClass("disabled").find("em").text(c)}var e=$(this);var d=$(this).attr("data-id"),b=$(this).attr("class").split(" ")[1].split("-")[0];$.ajax({url:gwc.api2,type:"post",dataType:"json",data:{order:"giveCollect",id:d,table:b},success:function(g){e.removeClass("disabled");gwc.appendPlugin("pop");if(g.state===-2){$(".login-btn").trigger("click")}else{if(g.state===-1){gwc.showPrompt('<i class="fa fa-slideshare"></i> 我会在这里等你的');var f=g.num==0?"收藏":"<b>"+g.num+"</b>收藏";$("."+b+"-collect-"+d).removeClass("red").find(".fa").addClass("fa-heart-o").removeClass("fa-heart").next().html(f)}else{if(g.state===1){gwc.showPrompt('<i class="fa fa-heartbeat"></i> 收藏成功！可在个人主页查看哟~ 积分+'+g.score);$("."+b+"-collect-"+d).addClass("red").find(".fa").removeClass("fa-heart-o").addClass("fa-heart").next().html("<b>"+g.num+"</b>已收藏")}}}},error:function(f){console.log(f)}})});$("body").delegate(".reply-sbt","click",function(){var e=$(this),b=$(this).parents(".comment-list"),d=b.find(".post_id").val(),a=$(this).hasClass("reply-post")?"":b.find(".repost_id").val(),c=$(this).parent().prev().find(".reply-ipt").val();if(gwc.checkIsHasUrl(c)){gwc.showPrompt("请勿发表带网址的内容");return}else{console.log("ok")}e.attr("disabled","disabled").attr("data-txt",e.val()).val("提交中...");$.ajax({url:gwc.api2,type:"post",dataType:"json",data:{order:"putComment",aid:d,rerepostid:a,content:c},success:function(f){console.log(f);if(f.state===0){gwc.showPrompt(f.tips);e.removeAttr("disabled").val(e.attr("data-txt"))}else{if(f.state===1){gwc.appendPlugin("pop");pop.alert(f.tips,"success",function(){e.removeAttr("disabled").val(e.attr("data-txt"));var g=Math.ceil(f.ridfloor/f.datanum);var h=f.ridfloor;if($("#insertNewCommentModule").length==0){gwc.appendModule("insertNewCommentModule");insertNewCommentModule.initCtrl(f.newrid,g,h)}else{insertNewCommentModule.initCtrl(f.newrid,g,h)}},2)}}},error:function(f){console.log(f)}})});$("body").delegate(".reply-btn","click",function(){$(this).parents(".comment-list").find(".repost_id").val($(this).attr("data-id"));if($(this).attr("data-aid")){$(this).parents(".comment-list").find(".post_id").val($(this).attr("data-aid"))}if($("#nickname").length===0){$(".login-btn").trigger("click")}else{$(this).parents(".mark-wrap").next().slideToggle().parents(".item").siblings().find(".reply-box").slideUp()
}});$(".comment-list .clear-txt").click(function(){gwc.appendPlugin("pop");pop.confirm("确定清除评论框中的内容吗？",function(){$(".reply-ipt").val("")})});$("body").delegate(".delete-reply-btn","click",function(){gwc.appendPlugin("pop");var a=$(this);pop.confirm("确定要删除本贴吗？",function(){$.ajax({url:gwc.api2,type:"post",dataType:"json",data:{order:"deleteReply",repostid:a.attr("data-id"),postuid:a.attr("data-uid")},success:function(b){gwc.showPrompt(b.tips);if(b.state===1){a.parents(".item").remove()}},error:function(b){console.log(b)}})})});$("body").delegate(".pack-up","click",function(){$(this).parents(".content").slideUp(function(){$(this).next().fadeIn()})});$("body").delegate(".open-down","click",function(){$(this).parent().hide().prev().slideDown()});$("body").delegate(".load-more a","click",function(){var a=$(this).parents(".content").find(".lazy-load-list");a.attr("data-height")===undefined&&a.attr("data-height",a.height());if($("#slideDownLoadMoreModule").length===0){gwc.appendModule("slideDownLoadMoreModule");slideDownLoadMoreModule.loadData($(this))}else{slideDownLoadMoreModule.loadData($(this))}});$(".search-wrap .fa").click(function(){if($(this).parent().hasClass("tips")){location.href="/search";return}if(gwc.winWidth<768){if($(".search-wrap .keywords").is(":hidden")){$(".search-wrap .drop-box").show();$(".header .drop-box .keywords").focus();$(".float-box").css("z-index",2147483646)}else{$(".search-wrap .drop-box").removeAttr("style");$(".float-box").removeAttr("style")}}else{var a=$(this).parent().find(".keywords");searchCtrl(a)}});$(".search-wrap .sbt").click(function(){var a=$(this).parent().find(".keywords");searchCtrl(a)});$(".search-wrap .close").click(function(){$(".search-wrap .drop-box").removeAttr("style")});$(".search-wrap .keywords").keydown(function(b){b=window.event||arguments[0];var a=b.keyCode;if(a==13){searchCtrl($(this))}});function searchCtrl(a){if(a.val()==""){gwc.showPrompt("请输入关键词")}else{location.href="/search/"+$.trim(a.val())}}if(gwc.winWidth<=768){$("a").removeAttr("target")}$(".open-hot-btn").click(function(){var b=$(this).find(".fa");var a=$(this).find("em");var c=$(this).parents(".left-content").next();if(b.hasClass("fa-angle-down")){a.text("收起热榜");b.removeClass("fa-angle-down").addClass("fa-angle-up");c.show()}else{a.text("展开热榜");b.removeClass("fa-angle-up").addClass("fa-angle-down");c.hide()}});$(".float-box .fa-history").click(function(){if($("#seeMoreBrowseRecordModule").length===0){gwc.appendModule("seeMoreBrowseRecordModule")}else{seeMoreBrowseRecordModule.getData()}});new Swiper(".main-nav.swiper-container",{slidesPerView:"auto",spaceBetween:0,freeMode:true});new Swiper(".hd-nav .swiper-container",{slidesPerView:"auto",spaceBetween:0,freeMode:true});new Swiper(".new-hot-movie .sub-category",{slidesPerView:"auto",spaceBetween:0,freeMode:true});new Swiper(".focus-rolling",{direction:"vertical",loop:true,autoplay:3000,autoplayDisableOnInteraction:false});